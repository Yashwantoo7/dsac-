var params={};params.discussionPage=0;params.iId="all";params.iType="problems";params.commentSlug="";params.page=1;params.solvedFilter=2;params.searchQuery="";params.sortBy="Newest";params.doubtAssistance=0;params.pType="";params.pId="";var sendAjax=1;function showErrorMsg(msg){$("#gfg-snackbar").text(msg);$("#gfg-snackbar").addClass("show");setTimeout(function(){$("#gfg-snackbar").removeClass("show")},3e3)}function shortenDescription(className){$(className).each(function(event){var max_length=250;if($(this).html().length>max_length&&!$(this).find(".short_text").length){var content=$(this).html();var short_content=content;short_content=short_content.substr(0,max_length);$(this).html('<div class="short_text">'+short_content+"</div>");$(this).append('<a href="#" class="read_more" style="color:darkgray;text-align:center;text-decoration:none;display:block;font-size:13px;">Read More</a>');$(this).append('<div class="complete_text" style="display:none;">'+content+"</div>")}})}function selectRateIcon(target){for(var i=1;i<=5;i++){$("#rating"+i).hide();$("#ratingIcon"+i).css("color","#333").attr("value","0")}$(target).css("color","#418c56").attr("value","1")}function getFeedbackForModerator(moderatorHandle){$("#moderatorFeedbackModal").show()}$("body").on("click","a.read_more",function(event){event.preventDefault();$(this).parent().find(".short_text").hide();$(this).hide();$(this).parent().find(".complete_text").show()});function fetchDiscussionHtml(){if(!sendAjax)return;sendAjax=0;if(Array.isArray(params.iId)){params.iId=params.iId.join()}var data=params;data["requestType"]="fetchAllCommentsOnItem";var tempId=params.iId;$.ajax({type:"GET",url:"/ajax/commentActions.php",data:data,dataType:"html",success:function(response){$("#forum-discussion").html(response);$("#discussion-loader").remove();$(".search_content").val(params.searchQuery);$("#reply-text").ckeditor({height:"150px",customConfig:"/ckeditor/custom_config-1.0.js?v=1.2",extraPlugins:"codesnippet,uploadimage,xml,textmatch,ajax,textwatcher,autocomplete,mentions,widget,lineutils,dialog,clipboard,mathjax"});$("#discussion-text").ckeditor({height:"150px",customConfig:"/ckeditor/custom_config-1.0.js?v=1.2",extraPlugins:"codesnippet,uploadimage,xml,textmatch,ajax,textwatcher,autocomplete,mentions,widget,lineutils,dialog,clipboard,mathjax"});shortenDescription(".discussion-desc");shortenDescription(".reply-desc");MathJax.Hub.Queue(["Typeset",MathJax.Hub]);$(".reply-desc > p img").addClass("img-responsive")},complete:function(){sendAjax=1;params.iId=tempId}});$("#forum-discussion").html("");$("<div id='discussion-loader' style='margin:10px auto;width:50px;height:50px;border-radius:50%;'></div>").insertAfter("#forum-discussion");$("#discussion-loader").css("background",'url("https://media.geeksforgeeks.org/img-practice/loader.gif") no-repeat center center rgba(0,0,0,0.25)');$("#discussion-loader").css("background-color","#fff")}$(document).ready(function(){var cssId="doubtSupportCss";if(!document.getElementById(cssId)){var head=document.getElementsByTagName("head")[0];var link=document.createElement("link");link.id=cssId;link.rel="stylesheet";link.type="text/css";link.href="/css/comment.css?v=1.4";link.media="all";head.appendChild(link)}var script_tag=document.getElementById("forum-script");var query=script_tag.src.replace(/^[^\?]+\??/,"");var vars=query.split("&");var args={};for(var i=0;i<vars.length;i++){var pair=vars[i].split("=");args[pair[0]]=pair[1]}params.iId=args["itemId"];params.iType=args["type"];params.commentSlug=args["commentSlug"];params.discussionPage=args["discussionPage"]===undefined?0:1;params.doubtAssistance=args["doubtAssistance"]===undefined||args["doubtAssistance"]==0?0:1;params.solvedFilter=args["solvedFilter"]===undefined?2:args["solvedFilter"];fetchDiscussionHtml();$("body").on("click",".pagination>li>a",function(e){e.preventDefault();params.page=$(this).text();fetchDiscussionHtml()});$("body").on("click",".discussion-title.openComment",function(e){params.commentSlug=$(this).parents(".discussion-post").attr("data-slug");if(params.commentSlug==""){showErrorMsg("Invalid Request");return}params.pId=params.iId;params.iId=$(this).parents(".discussion-post").attr("item-id");params.pType=params.iType;params.iType="discussion";params.page=1;fetchDiscussionHtml()});$("body").on("click",".discussion-list",function(e){params.commentSlug="";params.iId=params.pId;params.pId="";params.iType=params.pType;params.pType="";fetchDiscussionHtml()});$(".discussion-type.selectpicker").on("change",function(){changeDiscussionItems();params.iId="all";params.iType=$(this).val();fetchDiscussionHtml()});$(".discussion-slug").on("hide.bs.select",function(){params.iId=$(this).val();params.page=1;if(params.iId==null){params.iId="all"}fetchDiscussionHtml();console.log(params.iId)});$(".discussion-status").on("change",function(){params.page=1;params.solvedFilter=$(".discussion-status.selectpicker").val();fetchDiscussionHtml()});$(this).keydown(function(e){if($(".search_content:focus")&&e.keyCode===13){$(".discussion-search").click()}if(e.keyCode==27){$("#moderatorFeedbackModal").hide()}});$("body").on("click",".discussion-search",function(){params.page=1;params.searchQuery=$(".search_content").val();fetchDiscussionHtml()});$("body").on("click","#btnPostDiscussion",function(e){e.preventDefault();if($("#discussion-title").val()==""){showErrorMsg("Description title cannot be blank.");$("#discussion-title").closest(".form-group").addClass("has-error");return}if($("#discussion-text").val()==""){showErrorMsg("Description text cannot be blank.");$("#discussion-text").closest(".form-group").addClass("has-error");return}$("#btnPostDiscussion").text("Submitting..");var data=params;data["requestType"]="addNewComment";data["title"]=$("#discussion-title").val();data["description"]=$("#discussion-text").val();data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);if(response.status=="success"){$("#discussion-forum").modal("hide");$(".modal-backdrop").remove();$("body").removeClass("modal-open");params.page=1;fetchDiscussionHtml()}else{showErrorMsg(response.message)}},error:function(response){console.log("Error")}})});$("body").on("click",".sortby-menuitem",function(){$("#sortby-menu").find("span:eq(1)").html($(this).text());params.sortBy=$(this).text();fetchDiscussionHtml()});$("body").on("click",".comment-id-link",function(){params.iId=$(this).attr("id");params.iType="batch";fetchDiscussionHtml()});$("body").on("click",".editDiscussion",function(){if($(this).parents(".discussion-post").find(".comment-desc").find("#edit-discussion-text").length)return;$(this).closest(".discussion-post").find(".comment-desc").find(".math-tex").each(function(index){$(this).html("\\("+$(this).find("script").html()+"\\)")});var div=$(this).parents(".discussion-post").find(".comment-desc");var divHtml=$(div).html();var html='<div class="form-group"><a id="btnEditDiscussionClose" style="margin-right:5px;" class="btn btn-default btn-sm">Close</a><a id="btnEditDiscussion" class="btn btn-primary btn-sm">Edit</a></div>';var editableText=$("<textarea/>").attr({cols:"20",id:"edit-discussion-text"});editableText.val($(div).find(".complete_text").length?$(div).find(".complete_text").html():$(div).html());$(div).html(editableText);$(div).append(html);$(editableText).ckeditor({height:"150px",customConfig:"/ckeditor/custom_config-1.0.js?v=1.2",extraPlugins:"codesnippet,uploadimage,xml,textmatch,ajax,textwatcher,autocomplete,mentions,widget,lineutils,dialog,clipboard,mathjax"});document.getElementById("btnEditDiscussionClose").addEventListener("click",function(event){$(div).html(divHtml);MathJax.Hub.Queue(["Typeset",MathJax.Hub])});document.getElementById("btnEditDiscussion").addEventListener("click",function(event){if($("#edit-discussion-text").val()==""){showErrorMsg("Discussion text cannot be blank.");$("#edit-discussion-text").addClass("has-error");return}var div=$(this).parents(".discussion-post");var data=params;data["requestType"]="editComment";data["description"]=$("#edit-discussion-text").val();data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);if(response.status=="success"){$(div).replaceWith(response.message);shortenDescription(".comment-desc")}else{showErrorMsg(response.message)}MathJax.Hub.Queue(["Typeset",MathJax.Hub])},error:function(response){console.log("Error")}})})});$("body").on("click",".deleteDiscussion",function(){var div=$(this).parents(".discussion-post");var data=params;data["requestType"]="deleteComment";data["iType"]="discussion";data["commentSlug"]=div.attr("data-slug");data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);if(response.status=="success"){showErrorMsg(response.message);$(".discussion-list").click()}else{showErrorMsg(response.message)}},error:function(response){console.log("Error")}})});$("body").on("click",".markInappropriateDiscussion",function(){var div=$(this).parents(".discussion-post");var data=params;data["requestType"]="markInappropriateComment";data["iType"]="discussion";data["commentSlug"]=div.attr("data-slug");data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);showErrorMsg(response.message)},error:function(response){console.log("Error")}})});$("body").on("click",".pinDiscussion",function(){var div=$(this).parents(".discussion-post");var data=params;data["requestType"]="pinDiscussion";data["iType"]="discussion";data["commentSlug"]=div.attr("data-slug");data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);showErrorMsg(response.message);if(response.status=="success"){$(".comment-header").prepend('<span class="pinnedIcon"><i class="fa fa-thumb-tack"></i></span>');$(".pinDiscussion").parent().remove();$(".discussion-actions > .dropdown-menu").append('<li><a class="unpinDiscussion" style="cursor:pointer;">Unpin Discussion</a></li>')}},error:function(response){console.log("Error")}})});$("body").on("click",".unpinDiscussion",function(){var div=$(this).parents(".discussion-post");var data=params;data["requestType"]="unpinDiscussion";data["iType"]="discussion";data["commentSlug"]=div.attr("data-slug");data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);showErrorMsg(response.message);if(response.status=="success"){$(".pinnedIcon").remove();$(".unpinDiscussion").parent().remove();$(".discussion-actions > .dropdown-menu").append('<li><a class="pinDiscussion" style="cursor:pointer;">Pin Discussion</a></li>')}},error:function(response){console.log("Error")}})});$("body").on("click",".markAsSolved",function(){var div=$(this).parents(".discussion-post");var data=params;data["requestType"]="markAsSolved";data["iType"]="discussion";data["commentSlug"]=div.attr("data-slug");data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);showErrorMsg(response.message);if(response.status=="success"){$(".comment-header").append('<span class="markSolvedIcon"><i class="fas fa-check"></i></span>');$(".markAsSolved").parent().remove();$(".discussion-actions > .dropdown-menu").append('<li><a class="markAsUnresolved" style="cursor:pointer;">Mark As Unresolved</a></li>');if(response.require_feedback){$(".discussion-actions > .dropdown-menu").append('<li><a class="giveModeratorFeedback" style="cursor:pointer;">Give Feedback to Moderator</a></li>');getFeedbackForModerator($("#pickedByModeratorHandle").val())}}},error:function(response){console.log("Error")}})});$("body").on("click",".markAsUnresolved",function(){var div=$(this).parents(".discussion-post");var data=params;data["requestType"]="markAsUnresolved";data["iType"]="discussion";data["commentSlug"]=div.attr("data-slug");data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);showErrorMsg(response.message);if(response.status=="success"){$(".markSolvedIcon").remove();$(".markAsUnresolved").parent().remove();$(".giveModeratorFeedback").parent().remove();$(".discussion-actions > .dropdown-menu").append('<li><a class="markAsSolved" style="cursor:pointer;">Mark As Solved</a></li>')}},error:function(response){console.log("Error")}})});$("body").on("click",".editReply",function(){if($(this).parents(".reply-post").find(".reply-desc").find("#edit-reply-text").length)return;$(this).closest(".reply-post").find(".math-tex").each(function(index){$(this).html("\\("+$(this).find("script").html()+"\\)")});var div=$(this).parents(".reply-post").find(".reply-desc");var divHtml=div.html();var html='<div class="form-group pull-right"><a id="btnEditReplyClose" style="margin-right:5px;" class="btn btn-default btn-sm">Close</a><a id="btnEditReply" class="btn btn-primary btn-sm">Edit</a></div>';var editableText=$("<textarea/>").attr({cols:"20",id:"edit-reply-text"});editableText.val($(div).find(".complete_text").length?$(div).find(".complete_text").html():$(div).html());$(div).html(editableText);$(div).append(html);$(editableText).ckeditor({height:"150px",customConfig:"/ckeditor/custom_config-1.0.js?v=1.2",extraPlugins:"codesnippet,uploadimage,xml,textmatch,ajax,textwatcher,autocomplete,mentions,widget,lineutils,dialog,clipboard,mathjax"});document.getElementById("btnEditReplyClose").addEventListener("click",function(event){$(div).html(divHtml);MathJax.Hub.Queue(["Typeset",MathJax.Hub])});document.getElementById("btnEditReply").addEventListener("click",function(event){if($("#edit-reply-text").val()==""){showErrorMsg("Reply text cannot be blank.");$("#edit-reply-text").addClass("has-error");return}var div=$(this).parents(".reply-post");var replyId=$(div).attr("data-reply");var data=params;data["requestType"]="editReply";data["iType"]="discussion";data["replyId"]=replyId;data["replyText"]=$("#edit-reply-text").val();data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();data["commentSlug"]=$(this).parents("#discussion-thread").find(".discussion-post").attr("data-slug");$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);if(response.status=="success"){$(div).replaceWith(response.message);shortenDescription(".reply-desc")}else{showErrorMsg(response.message)}MathJax.Hub.Queue(["Typeset",MathJax.Hub])},error:function(response){console.log("Error")}})})});$("body").on("click",".deleteReply",function(){var div=$(this).parents(".reply-post");var replyId=$(div).attr("data-reply");var data=params;data["requestType"]="deleteReply";data["iType"]="discussion";data["replyId"]=replyId;data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);if(response.status=="success"){$(div).remove();showErrorMsg(response.message)}else{showErrorMsg(response.message)}},error:function(response){console.log("Error")}})});$("body").on("click",".markInappropriateReply",function(){var div=$(this).parents(".reply-post");var replyId=$(div).attr("data-reply");var data=params;data["requestType"]="markInappropriateReply";data["iType"]="discussion";data["replyId"]=replyId;data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);showErrorMsg(response.message)},error:function(response){console.log("Error")}})});$("body").on("click","#btnPostReply",function(e){e.preventDefault();if($("#reply-text").val()==""){showErrorMsg("Reply text cannot be blank.");$("#reply-text").closest(".form-group").addClass("has-error");return}if($("#commentAuthor").text().toLowerCase()==currentUser&&$(".markSolvedIcon").length){if(!confirm("Are you sure? You want to reopen the current thread")){return}}$("#btnPostReply").text("Submitting..");var data=params;data["requestType"]="addNewReply";data["iType"]="discussion";data["reply"]=$("#reply-text").val();data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();data["commentSlug"]=$(this).parents("#discussion-thread").find(".discussion-post").attr("data-slug");$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);if(response.status=="success"){if($("#reply-feed .reply-post").length){$("#reply-feed .reply-post:first").before(response.reply)}else{$("#reply-feed").append(response.reply)}$("#reply-text").val("");MathJax.Hub.Queue(["Typeset",MathJax.Hub]);shortenDescription(".reply-desc");$(".reply-desc").find("img").each(function(){if(!$(this).hasClass("img-responsive"))$(this).addClass("img-responsive")});if(response.resolved=="0"){$(".markSolvedIcon").remove();$(".markAsUnresolved").parent().remove();$(".discussion-actions > .dropdown-menu").append('<li><a class="markAsSolved" style="cursor:pointer;">Mark As Solved</a></li>')}}else{showErrorMsg(response.message)}},error:function(response){console.log("Error")},complete:function(response){$("#btnPostReply").text("Submit")}})});$("body").on("click",".pickComment",function(e){e.preventDefault();var data=params;var isBatchPage=typeof currentBatchId!="undefined"&&currentBatchId>0?true:false;if($(this).hasClass("singleDiscussion")||isBatchPage){if($(this).hasClass("singleDiscussion")){data["iType"]="discussion"}else if(isBatchPage){data["iType"]="batch"}else{data["iType"]="discussion"}data["iId"]=$(this).parents(".discussion-post").attr("item-id")}else{data["iType"]=params.iType?params.iType:"";data["iId"]=params.iId?params.iId:""}data["requestType"]="pickComment";data["commentSlug"]=$(this).parents(".discussion-post").attr("data-slug");data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();$(this).html("Aquiring Lock <i class='fas fa-spinner fa-spin'></i>");var curButton=$(this);$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);if(response.status=="success"){if(curButton.hasClass("singleDiscussion")){params.iId=curButton.parents(".discussion-post").attr("item-id");params.iType="discussion";params.page=1;fetchDiscussionHtml()}else{if(params.discussionPage){var id=curButton.parents(".discussion-post").attr("item-id");var slug=curButton.parents(".discussion-post").attr("data-slug");window.open("/discussion/"+id+"/"+slug+"/","_blank")}else{curButton.parents(".discussion-post").find(".discussion-title").click()}}}else{showErrorMsg(response.message)}},error:function(response){console.log("Error")},complete:function(response){curButton.html("Acquired")}})});$("body").on("click",".releaseComment",function(e){e.preventDefault();var data=params;data["requestType"]="releaseComment";data["commentSlug"]=$(this).parents("#discussion-thread").find(".discussion-post").attr("data-slug");data["iType"]="discussion";data["iId"]=$(this).parents("#discussion-thread").find(".discussion-post").attr("item-id");data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();var curButton=$(this);$(this).html("Releasing <i class='fas fa-spinner fa-spin'></i>");$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);if(response.status=="success"){$(".lockInfo").html('<a class="pickComment singleDiscussion">Acquire Lock</a>');if(response.self==true){$(".disqusDiv").hide()}$("#btnPostReply").text("Submit");$(".releaseComment").hide()}else{showErrorMsg(response.message);$(".releaseComment").text("Release Lock")}},error:function(response){console.log("Error")},complete:function(response){}})});$("body").on("click",".giveModeratorFeedback",function(){getFeedbackForModerator($("#pickedByModeratorHandle").val())});$("body").on("click","#submitFeedback",function(){let emojiRatingITags=$(".emojiRating");let ratingValue=undefined;for(let i=1;i<=emojiRatingITags.length;i+=1){if(emojiRatingITags[i-1].getAttribute("value")=="1"){ratingValue=i;break}}if(!ratingValue){showErrorMsg("Please rate in between 1 to 5");return}var div=$(".discussion-post");var data=params;data["iType"]="discussion";data["ctoken"]=$("#ctoken").val();data["utoken"]=$("#utoken").text();data["requestType"]="rateModeratorAndGiveFeedback";data["commentSlug"]=div.attr("data-slug");data["moderatorRating"]=ratingValue;data["moderatorFeedback"]=$("#feedbackContent").val();$.ajax({type:"POST",url:"/ajax/commentActions.php",data:data,dataType:"text",success:function(data){var response=JSON.parse(data);console.log(response);showErrorMsg(response.message);if(response.status=="success"){$("#moderatorFeedbackModal").hide();$(".giveModeratorFeedback").parent().remove()}},error:function(response){console.log("Error")}})});$("body").on("click","#moderatorFeedbackModal .close",function(){$("#moderatorFeedbackModal").hide()});$("body").on("click","#moderatorFeedbackModal.modal",function(event){if(event.target.id=="moderatorFeedbackModal")$("#moderatorFeedbackModal").hide()})});